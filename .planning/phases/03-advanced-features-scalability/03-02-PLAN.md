---
phase: 03-advanced-features-scalability
plan: 02
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - src/components/RecordingsTable.tsx
  - src/components/StatusBadge.tsx
  - src/components/WaveformPlaceholder.tsx
  - src/components/SidebarFilters.tsx
  - app/library/page.tsx
  - tailwind.config.js
autonomous: true
must_haves:
  truths:
    - "User sees a table with columns: Waveform, Title, Date, Duration, Status, Actions"
    - "Status badges reflect actual transcript presence (Transcribed, Audio Only)"
    - "Left sidebar shows filter buttons (Recent, Transcribed, Favorites)"
    - "Footer displays total recordings count and total duration"
  artifacts:
    - path: "src/components/RecordingsTable.tsx"
      provides: "Table view of recordings with all mock columns"
      exports: "RecordingsTable"
      min_lines: 80
    - path: "src/components/StatusBadge.tsx"
      provides: "Badge component for different status types"
      exports: "StatusBadge"
      contains: "Transcribed|Audio Only|Favorited|Transcribing"
    - path: "src/components/WaveformPlaceholder.tsx"
      provides: "Static bar visualization for waveform column"
      exports: "WaveformPlaceholder"
      min_lines: 20
    - path: "src/components/SidebarFilters.tsx"
      provides: "Filter buttons for library sidebar"
      exports: "SidebarFilters"
      min_lines: 30
    - path: "app/library/page.tsx"
      provides: "Updated library page with table and sidebar"
      contains: "<RecordingsTable"
    - path: "tailwind.config.js"
      provides: "Extended color palette matching mocks"
      contains: "slate-deep|indigo-primary|slate-muted"
  key_links:
    - from: "src/components/RecordingsTable.tsx"
      to: "src/components/StatusBadge.tsx"
      via: "import and usage"
      pattern: "import.*StatusBadge"
    - from: "app/library/page.tsx"
      to: "src/components/RecordingsTable.tsx"
      via: "import and render"
      pattern: "<RecordingsTable"
    - from: "src/components/RecordingsTable.tsx"
      to: "@/lib/fs/commands"
      via: "scanFolderForAudio data"
      pattern: "scanFolderForAudio|AudioItem"
---

<objective>
Build the Library page according to the UI mock: create a table view with waveform placeholder, status badges, and sidebar filters.

Purpose: Replace the existing RecordingsList with an enhanced table that matches the new design and provides clear recording status.
Output: Fully functional Library page that displays recordings in a table with accurate status badges and filter sidebar.
</objective>

<execution_context>
@~/.opencode/get-shit-done/workflows/execute-plan.md
@~/.opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-advanced-features-scalability/03-CONTEXT.md
@.planning/phases/03-advanced-features-scalability/03-01-SUMMARY.md (after 03-01 completes)

# Existing components to adapt
@src/components/RecordingsList.tsx
@src/components/Dashboard.tsx
@src/lib/fs/commands.ts
@src/lib/types.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extend Tailwind colors and create helper components</name>
  <files>tailwind.config.js, src/components/StatusBadge.tsx, src/components/WaveformPlaceholder.tsx</files>
  <action>
    1. **Update `tailwind.config.js`:**
       - Extend `theme.colors` with the custom colors from the mock:
         - `slate-deep: '#0f172a'`
         - `indigo-primary: '#6366f1'`
         - `slate-muted: '#64748b'`
         - `slate-border: '#1e293b'`
         - `slate-surface: '#1e293b4d'`
       - Ensure `darkMode: 'class'` is set (already present)

    2. **Create `StatusBadge.tsx`:**
       - Component accepts `status` prop: `'transcribed' | 'audio_only' | 'favorited' | 'transcribing'`
       - Returns a styled `<span>` with appropriate colors:
         - Transcribed: emerald background, emerald text
         - Audio Only: slate background, slate text
         - Favorited: indigo background, indigo text
         - Transcribing: amber background, amber text
       - Use text-xs, uppercase, font-bold, rounded, px-2 py-0.5
       - Export as `export function StatusBadge({ status }: { status: string })`

    3. **Create `WaveformPlaceholder.tsx`:**
       - Generate 8 vertical bars with random heights (between 20% and 100%)
       - Use `bg-indigo-primary/40` for transcribed recordings, `bg-slate-700` for audio‑only
       - Accept a `transcribed` boolean prop to switch color
       - Fixed width: `w-24`, height: `h-6`, flex layout
       - Export as `export function WaveformPlaceholder({ transcribed }: { transcribed: boolean })`
  </action>
  <verify>
    - Tailwind config compiles (run `npm run dev` and check for errors)
    - StatusBadge renders each variant correctly in Storybook or simple test
    - WaveformPlaceholder renders bars with appropriate colors
  </verify>
  <done>Tailwind colors extended; StatusBadge and WaveformPlaceholder components ready.</done>
</task>

<task type="auto">
  <name>Task 2: Create SidebarFilters and integrate into Library page</name>
  <files>src/components/SidebarFilters.tsx, app/library/page.tsx</files>
  <action>
    1. **Create `SidebarFilters.tsx`:**
       - Render three filter buttons: Recent, Transcribed, Favorites
       - Each button: icon (Material Symbols), label, hover states
       - Use `material-symbols-outlined` class for icons
       - Style matching mock: `px-3 py-2 text-sm text-slate-400 hover:text-slate-200 hover:bg-slate-800/30 rounded-lg`
       - Buttons are non‑functional for now (no click handlers)
       - Export as `export function SidebarFilters()`

    2. **Update `app/library/page.tsx`:**
       - Import `SidebarFilters`, `RecordingsTable` (to be created in Task 3)
       - Replace placeholder content with the proper layout:
         - Outer container: `flex flex-1 overflow-hidden`
         - Left aside: `w-64 border-r border-slate-border p-4` containing `<SidebarFilters />`
         - Main: `flex-1 flex flex-col overflow-hidden`
         - Header area with breadcrumb "My Files / All Recordings" and view toggle buttons (grid/list)
         - Content area with `<RecordingsTable />` (to be added)
         - Footer: Use `<Footer>` with library‑specific stats (total recordings, total duration)
       - Fetch recordings data using existing `scanFolderForAudio` (copy logic from Dashboard)
       - Calculate total duration across all recordings
       - Pass recordings data to `RecordingsTable`
  </action>
  <verify>
    - Library page renders sidebar with three filter buttons
    - Breadcrumb and view toggle buttons appear (non‑functional)
    - Footer shows "Total Recordings: X" and "Total Duration: Y"
    - No TypeScript errors
  </verify>
  <done>Library page has sidebar filters and layout structure; recordings data loaded.</done>
</task>

<task type="auto">
  <name>Task 3: Create RecordingsTable component</name>
  <files>src/components/RecordingsTable.tsx</files>
  <action>
    Create a table component that matches the mock's design:

    1. **Props:** Accept `recordings: AudioItem[]` and `onSelect?: (id: string) => void`
    2. **Columns:** Waveform, Title, Date, Duration, Status, Actions
    3. **Waveform column:** Render `<WaveformPlaceholder transcribed={hasTranscript} />`
    4. **Title column:** File name (use `recording.name`), styled with `text-slate-200 font-medium`
    5. **Date column:** Format `recording.mtime` as "MMM DD, YYYY" using `new Date().toLocaleDateString`
    6. **Duration column:** Format seconds as "MM:SS" (minutes:seconds)
    7. **Status column:** Determine status:
       - If transcript file exists → 'transcribed'
       - Otherwise → 'audio_only'
       - (Future: 'favorited', 'transcribing')
       - Render `<StatusBadge status={status} />`
    8. **Actions column:** Three‑dots menu button (Material Symbols `more_horiz`)
    9. **Table styling:**
       - Use `<table>` with `border-separate border-spacing-0`
       - Header: `text-[10px] font-bold text-slate-500 uppercase tracking-widest`
       - Rows: `table-row-hover` class (add to global CSS), `border-b border-slate-border/30`
       - Row hover: `hover:bg-slate-800/30`

    10. **Check transcript existence:**
        - Use `readTranscript` from `@/lib/transcription/commands` to check if transcript exists
        - Cache results to avoid repeated file reads

    11. **Click behavior:** Clicking a row should call `onSelect` with recording ID (will navigate to editor later)

    Export as `export function RecordingsTable({ recordings, onSelect }: { recordings: AudioItem[], onSelect?: (id: string) => void })`
  </action>
  <verify>
    - Component renders a table with correct column headers
    - Each row shows waveform placeholder, title, date, duration, status badge, actions button
    - Status badges reflect actual transcript presence
    - Hover effects work
    - No console errors when clicking rows or buttons
  </verify>
  <done>RecordingsTable component fully functional, integrated into Library page.</done>
</task>

</tasks>

<verification>
After completing all tasks:
1. Visit `/library` – see table with recordings (if any)
2. Verify each column renders correctly
3. Check that status badges match transcript existence
4. Confirm sidebar filters appear
5. Footer shows correct totals
6. Table rows are clickable (logs ID)
</verification>

<success_criteria>
- [ ] Library page displays recordings in a table with six columns
- [ ] Status badges show "Transcribed" for recordings with transcript files, "Audio Only" otherwise
- [ ] Sidebar filters appear (non‑functional)
- [ ] Footer shows total recordings count and total duration
- [ ] Clicking a table row logs the recording ID (or navigates later)
</success_criteria>

<output>
After completion, create `.planning/phases/03-advanced-features-scalability/03-02-SUMMARY.md`
</output>