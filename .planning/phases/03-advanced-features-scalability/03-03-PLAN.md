---
phase: 03-advanced-features-scalability
plan: 03
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - src/components/PlayerSidebar.tsx
  - src/components/Player.tsx
  - app/editor/page.tsx
autonomous: true
must_haves:
  truths:
    - "Editor page displays three‑column layout (player sidebar, main, insights sidebar)"
    - "Player sidebar shows recording title, date, size, waveform, and playback controls"
    - "Play/pause, skip‑back/forward buttons work"
    - "Waveform shows active position (some bars highlighted)"
  artifacts:
    - path: "src/components/PlayerSidebar.tsx"
      provides: "Enhanced player with waveform and metadata"
      exports: "PlayerSidebar"
      min_lines: 70
    - path: "src/components/Player.tsx"
      provides: "Updated Player component with skip controls"
      contains: "forward_10|replay_10"
    - path: "app/editor/page.tsx"
      provides: "Editor page with three‑column grid"
      contains: "grid-cols-[320px_1fr_360px]"
  key_links:
    - from: "src/components/PlayerSidebar.tsx"
      to: "src/components/Player.tsx"
      via: "import and composition"
      pattern: "import.*Player"
    - from: "app/editor/page.tsx"
      to: "src/components/PlayerSidebar.tsx"
      via: "import and render"
      pattern: "<PlayerSidebar"
---

<objective>
Build the Editor page layout and enhance the Player component to match the UI mock's left sidebar (waveform, playback controls, metadata).

Purpose: Provide the foundation for the Editor page – a dedicated player sidebar with improved controls and visual feedback.
Output: Editor page with three‑column layout, functional player sidebar, and placeholder areas for transcript and insights.
</objective>

<execution_context>
@~/.opencode/get-shit-done/workflows/execute-plan.md
@~/.opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-advanced-features-scalability/03-CONTEXT.md
@.planning/phases/03-advanced-features-scalability/03-01-SUMMARY.md (after 03-01 completes)

# Existing player component
@src/components/Player.tsx
@src/lib/types.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Enhance Player component with skip controls</name>
  <files>src/components/Player.tsx</files>
  <action>
    Update the existing `Player` component to support skip‑forward/backward buttons:

    1. **Add two new buttons** beside the play/pause button:
       - "Replay 10s" (Material Symbols `replay_10`)
       - "Forward 10s" (`forward_10`)
       - Style as text buttons: `text-slate-400 hover:text-slate-100`

    2. **Implement skip functionality:**
       - When "Replay 10s" clicked, seek `currentTime - 10` (clamp to 0)
       - When "Forward 10s" clicked, seek `currentTime + 10` (clamp to duration)
       - Use the existing `audioRef.current.currentTime` setter

    3. **Update the play/pause button** to match mock style:
       - Circular button: `size-12 rounded-full bg-indigo-primary text-white`
       - Use `pause` icon when playing, `play_arrow` when paused
       - Hover effect: `hover:scale-105 transition-transform`

    4. **Keep existing functionality:** volume, seek bar, time display, etc.

    5. **Add Material Symbols classes:**
       - Ensure icons use `material-symbols-outlined` with appropriate size modifiers

    Do not break existing usage in Dashboard (which will be removed later).
  </action>
  <verify>
    - Player still plays/pauses audio
    - Skip buttons seek correctly (±10 seconds)
    - Play/pause button matches mock styling (circular, indigo)
    - No regression in volume control or seek bar
  </verify>
  <done>Player component enhanced with skip controls and updated styling.</done>
</task>

<task type="auto">
  <name>Task 2: Create PlayerSidebar component</name>
  <files>src/components/PlayerSidebar.tsx</files>
  <action>
    Create a sidebar component that wraps the Player with additional metadata and waveform:

    1. **Props:** Accept `recording: AudioItem | null`
    2. **Title section:**
       - `<h2>` with recording name (truncate)
       - Metadata row: date (`calendar_today`), file size (`database`)
       - Use Material Symbols icons

    3. **Waveform visualization:**
       - Create a container `flex items-end justify-between gap-1 h-32`
       - Generate 18 vertical bars with random heights (20%–100%)
       - First 9 bars should have class `waveform-bar active` (add `active` class)
       - Style: `waveform-bar` → `bg-indigo-primary/30 rounded-full transition-all duration-300`
       - Active bars: `bg-indigo-primary`
       - Width: `4px` each

    4. **Time labels:** "12:45" (current) left, "45:12" (total) right (hard‑coded for now)

    5. **Player controls:** Render the enhanced `Player` component centered below waveform

    6. **Container styling:**
       - `bg-slate-900/50 border border-slate-border rounded-2xl p-6`
       - Fixed width: `w-[320px]` (matches mock)

    7. **Integration:** Import `Player` and render it inside the sidebar.

    Export as `export function PlayerSidebar({ recording }: { recording: AudioItem | null })`
  </action>
  <verify>
    - Component renders recording title and metadata
    - Waveform shows 18 bars with first 9 highlighted
    - Player controls appear and work
    - Styling matches mock (rounded container, spacing)
  </verify>
  <done>PlayerSidebar component created with waveform and enhanced player.</done>
</task>

<task type="auto">
  <name>Task 3: Update Editor page layout</name>
  <files>app/editor/page.tsx</files>
  <action>
    Transform the Editor page placeholder into the three‑column layout:

    1. **Read query parameter:** Use `useSearchParams` to get `recording` ID
    2. **Fetch recording data:** Use `scanFolderForAudio` to get all recordings, find the matching one (or use mock if none)
    3. **Layout structure:**
       ```
       <div className="flex flex-1 overflow-hidden">
         <PlayerSidebar recording={selectedRecording} />
         <main className="flex-1 flex flex-col bg-slate-deep overflow-hidden border-r border-slate-border">
           {/* Transcript area placeholder */}
           <div className="p-8">Transcript will go here</div>
         </main>
         <aside className="w-[360px] flex flex-col bg-slate-deep overflow-y-auto">
           {/* Insights placeholder */}
           <div className="p-6">AI Insights will go here</div>
         </aside>
       </div>
       ```
    4. **Add Editor‑specific footer:** Use `<Footer>` with:
       - Auto‑scroll toggle (placeholder)
       - Word count (0 for now)
       - Language (EN‑US)
       - Keyboard shortcuts hint

    5. **Header area:** Add a search bar and Edit/Export buttons (non‑functional for now) inside the main column's header:
       - Create a `div` with `h-16 px-6 border-b border-slate-border flex items-center justify-between`
       - Search input with magnifying glass icon
       - Two buttons: Edit (slate), Export (indigo)

    6. **Ensure responsive height:** The three columns should fill available vertical space.

    The page should look like the mock's structure, with placeholders for transcript and insights.
  </action>
  <verify>
    - Editor page loads without errors
    - Three‑column layout appears (player sidebar, main, insights sidebar)
    - Player sidebar shows recording data (or placeholder)
    - Header area with search and buttons appears in main column
    - Footer shows editor‑specific stats
    - Navigation to Editor with `?recording=id` works (ID passed from Library later)
  </verify>
  <done>Editor page has correct layout with player sidebar, header area, and placeholders.</done>
</task>

</tasks>

<verification>
After completing all tasks:
1. Navigate to `/editor` – see three‑column layout
2. Verify PlayerSidebar renders waveform and controls
3. Test playback controls (play/pause, skip) with a mock audio file
4. Check that query parameter `recording` is read (log to console)
5. Confirm editor‑specific footer appears
</verification>

<success_criteria>
- [ ] Editor page displays three‑column layout (player sidebar, main, insights sidebar)
- [ ] Player sidebar shows waveform with active bars and functional playback controls
- [ ] Skip‑forward/backward buttons work (±10 seconds)
- [ ] Editor header area contains search bar and Edit/Export buttons
- [ ] Editor footer shows placeholder stats (word count, language, etc.)
</success_criteria>

<output>
After completion, create `.planning/phases/03-advanced-features-scalability/03-03-SUMMARY.md`
</output>